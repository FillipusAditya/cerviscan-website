{% extends 'base.html' %} {% block title %}Patient Form{% endblock %} {% block
content %}
<div class="container">
    <div class="card">
        <h2 class="title">Patient Profile</h2>
        <form
            action="/"
            method="POST"
            enctype="multipart/form-data"
            class="form"
        >
            <div class="form-group">
                <label for="first_name">First Name:</label>
                <input
                    type="text"
                    id="first_name"
                    name="first_name"
                    placeholder="Patient's First Name"
                    required
                />
            </div>
            <div class="form-group">
                <label for="last_name">Last Name:</label>
                <input
                    type="text"
                    id="last_name"
                    name="last_name"
                    placeholder="Patient's Last Name"
                    required
                />
            </div>
            <div class="form-group">
                <label for="dob">Date of Birth:</label>
                <input type="date" id="dob" name="dob" required />
            </div>
            <div class="form-group">
                <label for="image">Upload Image:</label>
                <input
                    type="file"
                    id="image"
                    name="image"
                    accept="image/*"
                    onchange="previewImage(event)"
                    required
                />
            </div>
            <div id="image-preview" style="margin-top: 10px"></div>
            <button type="submit" class="btn">Go Scan</button>
        </form>
    </div>

    {% if result %}
    <div class="card">
        <h2 class="title">Result</h2>
        {% if result.prediction == 0 %}
        <div class="prediction-tag" style="background-color: rgb(40, 244, 40)">
            <p>Normal</p>
        </div>
        {% else %}
        <div class="prediction-tag" style="background-color: rgb(244, 40, 40)">
            <p>Abnormal</p>
        </div>
        {% endif %}
        <div class="result-section grid">
            <div>
                <h3>RGB</h3>
                <img src="{{ result.original }}" alt="Original Image" />
            </div>
            <div>
                <h3>Gray</h3>
                <img src="{{ result.gray }}" alt="Gray Image" />
            </div>
            <div>
                <h3>Mask</h3>
                <img src="{{ result.mask }}" alt="Mask Image" />
            </div>
            <div>
                <h3>Segmented</h3>
                <img src="{{ result.segmented }}" alt="Segmented Image" />
            </div>
        </div>
    </div>
    {% endif %}
</div>

<script>
    function previewImage(event) {
        const previewDiv = document.getElementById("image-preview");
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                previewDiv.innerHTML = `<img src="${e.target.result}" alt="Image Preview" style="max-width: 30%; height: auto;"/>`;
            };
            reader.readAsDataURL(file);
        }
    }
</script>
{% endblock %}
